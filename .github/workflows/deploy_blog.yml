name: Deploy Blog

on: [push]

jobs:
  build:

    runs-on: ubuntu-18.04

    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v2-beta
      with:
          node-version: '12'
        
    - name: Install Hexo
      run: |
        npm install hexo-cli -g
        npm install
        npm install hexo-deployer-git --save
        npm install hexo-next-three --save
        npm install hexo-generator-searchdb --save
        git clone git@github.com:next-theme/theme-next-fancybox3  --depth=1 themes/next/source/lib/fancybox
        git clone git@github.com:next-theme/theme-next-pace --depth=1 themes/next/source/lib/pace
        
    - name: Hexi generate
      run: |
        hexo clean
        hexo g
  
    - name: Build and Deploy
      uses: y4code/hexo-deploy-action@master
      env:
        PERSONAL_TOKEN: ${{ secrets.REPO_TOKEN }}
        PUBLISH_REPOSITORY: Magic-Xin/Magic-Xin.github.io
        BRANCH: master
        PUBLISH_DIR: ./
